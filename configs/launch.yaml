repo:
  path: "./repos/java/spring-ai"
  commit: ""

language:
  name: "java"
  profile_dir: "configs/language"

llm:
  provider: "ollama"
  base_url: "http://localhost:11434/v1"
  model: "qwen2.5:7b"
  temperature: 0.2
  max_tokens: 10000
  timeout_sec: 180

core:
  seed: 42
  retrieval_top_k: 6
  max_context_chars: 16000
  max_items: 50

method_understanding:
  enabled: true
  max_methods: 5

question_answer:
  questions_per_method: 3
  max_questions: 20
  batch_size: 5
  embedding_model: "nomic-embed-text"
  user_questions_path: "configs/user_inputs/user_questions.yaml"
  build_embeddings_in_user_mode: true

design_questions:
  min_evidence_refs: 2
  use_method_profiles: true
  profiles_top_k: 20
  profiles_max_chars: 6000
  require_layer_coverage: true
  batch_size: 5
  max_questions: 20
  user_questions_path: "configs/user_inputs/design_questions.yaml"
  batching:
    enabled: true
    max_batches: 5
    diversity_hint: true

prompts:
  method_understanding: "configs/prompts/method_understanding/auto_method_understanding.txt"
  question_answer:
    question_generation: "configs/prompts/question_answer/auto_question_generation.txt"
    answer_generation: "configs/prompts/question_answer/auto_answer_generation.txt"
  design_questions_generation: "configs/prompts/design/auto_design_question_generation.txt"

artifacts:
  method_profiles_jsonl: "data/intermediate/method_profiles.jsonl"
  auto_method_understanding_rejected_jsonl: "data/intermediate/rejected/auto_method_understanding_rejected.jsonl"
  questions_jsonl: "data/intermediate/auto_questions/questions.jsonl"
  method_embeddings_jsonl: "data/intermediate/method_embeddings.jsonl"
  auto_qa_raw_jsonl: "data/intermediate/auto_qa_raw.jsonl"
  auto_answer_rejected_jsonl: "data/intermediate/rejected/auto_answer_rejected.jsonl"
  qa_clean_jsonl: "data/intermediate/clean/qa_clean.jsonl"
  design_questions_jsonl: "data/intermediate/auto_questions/design_questions_auto.jsonl"
  design_questions_rejected_jsonl: "data/intermediate/rejected/design_questions_auto_rejected.jsonl"
  design_questions_snapshot_jsonl: "data/intermediate/auto_questions/design_questions.jsonl"
  design_rejected_jsonl: "data/intermediate/rejected/design_rejected.jsonl"
  design_clean_jsonl: "data/intermediate/clean/design_clean.jsonl"

quality:
  gate_mode: "gate"
  write_clean: true
  allow_fallback_in_report: true
  fail_on_warnings: false
  min_instruction_length: 10
  min_answer_length: 20
  max_answer_length: 6000

dedup:
  simhash_bits: 64
  max_hamming: 3

split:
  train_ratio: 0.8
  val_ratio: 0.1
  test_ratio: 0.1
  group_by: "package"

safety:
  mode: "drop"

output:
  raw_dir: "data/raw/extracted"
  repo_meta_dir: "data/raw/repo_meta"
  intermediate_dir: "data/intermediate"
  final_dir: "data/final"
  reports_dir: "data/reports"
  qa_final_dir: "data/final/qa"
  design_final_dir: "data/final/design"

logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/pipeline.log"
